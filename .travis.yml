language: python
dist: xenial

python:
  - "3.6"
  - "3.7"

cache: pip
# command to install dependencies
#env:
#  - TEST_FILE=tests/test_corpus.py
#  - TEST_FILE=tests/test_pre_processor.py
before_install:
  - export BOTO_CONFIG=/dev/null
install:
  - pip install jieba
  - pip install python-coveralls
  - pip install -e .
  - pip install tensorflow==1.13.1
  - pip install coverage
  - pip install nose
  - pip install pytest pytest-cov
  - pip install flake8 flake8-builtins
  - python -c "import kashgari;print(f'kashgari version {kashgari.__version__}')"

addons:
  sonarcloud:
    organization: "brikerman-github"
    token:
      secure: $SONAR_TOKEN

script:
  - git fetch --unshallow --quiet
  - flake8 kashgari
  - pytest tests/ --cov kashgari --cov-report html
  - coverage xml -i
  - sonar-scanner

after_success:
  - coveralls
